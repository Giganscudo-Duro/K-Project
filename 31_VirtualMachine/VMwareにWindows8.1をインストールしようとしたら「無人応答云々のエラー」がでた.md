# VMware 環境での Windows 8.1 Pro の構築手順

## 事前準備
用意したものは以下
- Windows 8.1 Pro のインストールディスク
- Windows 8.1 Pro のプロダクトキー
- VMware Player で作った仮想化ホスト環境



## インストール手順
もうすぐ忘れるから全部書く。

1. VMware Player を起動
2. [新規仮想マシンの作成]をクリックし、新規仮想マシン作成ウィザードを開く。
3. 新規仮想マシン作成ウィザードで以下を実施
    1. インストール元の選択  
        3つの選択肢から、[後でOSをインストール]を選択  
        絶対に「簡単インストールを実施するDVDドライブ～」は選択しちゃダメ  
    2. ゲストOSの選択  
        ゲストOS：[Microsoft Windows] を選択
        バージョン：[Windows 8.x x64] を選択
    3. 仮想マシンの名前  
        仮想マシン名：適当に指定  
        場所：仮想マシン名から勝手に決まる
    4. ディスク容量の指定  
        ディスク最大サイズ：適当に指定
        仮想ディスクの方式：適当に指定
    5. ハードウェアをカスタマイズ  
        ボタンを押して設定画面を出して、以下を実施。  
        **フロッピーディスクを削除する**
    6. [完了]を実施
4. 仮想マシンが作成されたら起動
5. 通常のWindowsインストーラが起動するので、手元のクトキーを入力してインストール
6. 8.1 Pro としてのOSがインストールされる




----
# 問題１：セットアップしようとしたら「無人応答云々」のエラー
## 概要
Windows 10 環境に構築した VMware Workstation 16 Player 環境に対し、
Windows 8.1 Proとをインストールしようとしたら、セットアップの段階で、
以下のエラーが出た。
```txt
無人応答ファイルに無効なプロダクトキーが含まれています。
Windows のインストールを続行するには無人応答ファイルから無効なキーを削除するか、または、無人応答ファイルに有効なプロダクトキーを提供してください。
```

## 解決策
インストールプログラムが、インストール情報ファイルをインストールディスク以外も検索してしまう事により発生する事が原因のようです。

解決策は、該当の仮想マシンの設定を編集し、以下のいずれかを実施する必要がある
- フロッピードライブを無効にする
-フロッピードライブを削除する

この変更の後にセットアップを行えば、先のエラーが出ずに、インストール処理が進んだ。


## 参考URL
- [VMwareにWindows8.1をインストールしようとしたら無人応答・・のエラー]( https://blog.washo3.com/vmwarefusion-win8-setup-err/ )
    スクショもあって、原因の説明もあり、わかりやすかった


----
# 問題２：ライセンス認証で「このエディションの云々」のエラー

## 概要
簡単インストールを使ってインストールしたものの、ライセンス認証で詰まった。
プロダクトキーを入力しても、以下のエラーがでて通らない

```txt
このエディションのwindowsのライセンス認証にそのキーは使えません
```

## 解決策

ライセンス認証画面の下部をみると、現在のキーは「XXXXXXXXX-D3VPT」と表示されていた。
コレは、OSインストール時にとりあえず入力されるGenericKeyなるものらしい。

ちなみに以下のパターンがあるとのこと。
| OS のバージョン    | GenericKey                      |
|--------------------|---------------------------------|
| Windows 8.1（無印）| `334NH-RXG76-64THK-C7CKG-D3VPT` |
| Windows 8.1 Pro    | `XHQ8N-C3MCJ-RQXB6-WCHYG-C9WKB` |
| Windows 10 Home    | `TX9XD-98N7V-6WMQ6-BX7FG-H8Q99` |

で、上記と照らし合わせると、作成された仮想マシンは「Windows 8.1 (無印)」相当のキーでとりあえず認証されている事がわかった。
VMware Player の簡単インストールはここら辺がいい加減らしく、この影響でこのマシンは「8.1 (無印)」として認識されているみたい。

手元にあるのは 8.1 Pro のキーなので、結果としてエディションが違うと判断され、はじかれちゃったっぽい。
簡単インストールを使うと、上記の状態になってしまうので、面倒でもそれを使わないようにして環境をインストールする。


## 参考URL
https://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q10189845495
https://www.teradas.net/archives/15107/

